(window.webpackJsonp=window.webpackJsonp||[]).push([[152],{610:function(s,t,a){"use strict";a.r(t);var e=a(3),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"ssh-copy-id"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ssh-copy-id"}},[s._v("#")]),s._v(" ssh-copy-id")]),s._v(" "),t("p",[s._v("把本地的ssh 公钥 安装到远程主机对应的账户上(authorized_keys文件中)。")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("当我们第一次 "),t("code",[s._v("ssh root@192.168.1.6")]),s._v(" 连接远程主机时，如果主机信息没有记录在 本地的 known_hosts 文件中， 将询问你是否获取远程主机的公钥,\n如果输入 yes， 则会将远程主机的公钥 添加到 known_hosts文件中。")])]),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# ssh-copy-id -i "公钥文件位置" "远程主机"')]),s._v("\n\nssh-copy-id "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" ~/.ssh/id_rsa.pub "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".1.217\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("以该命令为例： "),t("code",[s._v("ssh-copy-id -i /root/.ssh/rsa_key.pub root@192.168.1.217")]),s._v(", 具体执行流程： 会将本台主机指定\n的公钥文件安装到 远程主机 root用户的 /root/.ssh/authorized_keys 文件中。下次登录时 ，远程主机中拥有公钥， 登录时只需指定私钥文件即可进行\n免密登录")])]),t("h3",{attrs:{id:"ssh相关文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ssh相关文件"}},[s._v("#")]),s._v(" ssh相关文件")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",{staticStyle:{"text-align":"center"}},[s._v("文件")]),s._v(" "),t("th",{staticStyle:{"text-align":"center"}},[s._v("作用")])])]),s._v(" "),t("tbody",[t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("authorized_keys")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("我们需要本地机器ssh访问远程服务器时为了减少输入密码的步骤，基本上都会在本地机器生成ssh公钥，然后将本地ssh公钥复制到远程服务器的.ssh/authorized_keys中，这样就可以免密登录了。")])]),s._v(" "),t("tr",[t("td",{staticStyle:{"text-align":"center"}},[s._v("known_hosts")]),s._v(" "),t("td",{staticStyle:{"text-align":"center"}},[s._v("第一次连接远程数据库时我们可以发现我们本地的.ssh/目录下多了一个文件known_hosts，里面有我们刚刚连接的服务器的信息（如果以前就存在known_hosts，则会发现多了刚刚连接的服务器的信息）。")])])])]),s._v(" "),t("h2",{attrs:{id:"ssh登录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ssh登录"}},[s._v("#")]),s._v(" ssh登录")]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[t("code",[s._v("SSH")]),s._v("的全称为"),t("code",[s._v("Secure Shell")]),s._v("，即安全外壳协议。它是一种专为远程登陆会话和网络服务提供安全性的应用层协议；主要功能是安全的连接到服务器。")])]),t("h3",{attrs:{id:"ssh登录方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ssh登录方式"}},[s._v("#")]),s._v(" ssh登录方式")]),s._v(" "),t("ul",[t("li",[s._v("口令验证登录\n"),t("ol",[t("li",[t("strong",[s._v("服务器生成公钥和私钥")])]),s._v(" "),t("li",[s._v("客户端发起连接请求，服务器将公钥发给客户端")]),s._v(" "),t("li",[s._v("客户端输入口令（服务器密码），并用服务器发来的公钥加密，发送给服务器")]),s._v(" "),t("li",[s._v("服务器通过私钥解密，拿到口令（服务器密码）")]),s._v(" "),t("li",[s._v("如果正确则认证成功")])])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("这种方式是我们管理但机器最常用的ssh连接远程服务器的方式，优点是无需进行额外的配置；但缺点是需要记住服务器主机的密码，并且第一次建立连接时需要手动接收服务器证书。")])]),t("ul",[t("li",[t("p",[s._v("密钥验证登录")]),s._v(" "),t("ol",[t("li",[t("strong",[s._v("客户端生成公钥和私钥")]),s._v("，将公钥提前部署在服务器上")]),s._v(" "),t("li",[s._v("客户端发起连接请求")]),s._v(" "),t("li",[s._v("服务器随机生成一个字符串，使用本地的公钥加密，发送给客户端")]),s._v(" "),t("li",[s._v("客户端通过私钥解密，将解密后的字符串发送给服务器")]),s._v(" "),t("li",[s._v("服务器验证本地字符串和客户端发来的字符串的一致性，如果通过，则认证成功")])])])]),s._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("这种方式连接的前提是服务器需要有客户端公钥，优点是不需要记住服务器密码，适合大规模集群管理")])]),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"title"}),t("p",[s._v("客户端密钥对可以通过"),t("code",[s._v("ssh-keygen")]),s._v("生成，然后使用"),t("code",[s._v("ssh-copy-id")]),s._v("将公钥拷贝到服务器上")])]),t("h3",{attrs:{id:"使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[s._v("#")]),s._v(" 使用")]),s._v(" "),t("p",[s._v("使用密钥的方式登录时， 客户端密钥一般存放在服务器的"),t("code",[s._v("~/.ssh/authorized_key")]),s._v("目录中（其中"),t("code",[s._v("~")]),s._v("\n指的是客户端登录服务器时指定的用户名），用户在登录的时候指定使用到的私钥和登录服务器的用户名和ip地址。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 密钥的方式登录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" ./root_key.pem root@54.243.22.210\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 客户端生成公钥和私钥, 将公钥文件上传的服务器上，然后在追加到 authorized_keys 文件中")]),s._v("\nssh-keygen "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" rsa\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /root/id_rsa.pub "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /root/.ssh/authorized_keys\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 密码的方式登录")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ssh 用户名:密码@主机地址")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6688")]),s._v(" root:123@192.168.1.128\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])])])}),[],!1,null,null,null);t.default=n.exports}}]);