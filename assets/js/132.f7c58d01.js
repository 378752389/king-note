(window.webpackJsonp=window.webpackJsonp||[]).push([[132],{591:function(s,a,e){"use strict";e.r(a);var n=e(3),t=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"github证书格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#github证书格式"}},[s._v("#")]),s._v(" github证书格式")]),s._v(" "),a("details",{staticClass:"custom-block details"},[a("summary",[s._v("参考文档")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.openssl.org/docs/man3.0/man5/x509v3_config.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("x509v3参数解释"),a("OutboundLink")],1)])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载 github 证书")]),s._v("\nopenssl s_client "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-connect")]),s._v(" github.com:443 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-showcerts")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'/-----BEGIN/,/-----END/p'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" github.com.crt\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 打印证书内容")]),s._v("\nopenssl x509 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-in")]),s._v(" github.com.crt "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-text")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-noout")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("github证书内容如下：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Certificate:\n    Data:\n        Version: 3 (0x2)\n        Serial Number:\n            0c:d0:a8:be:c6:32:cf:e6:45:ec:a0:a9:b0:84:fb:1c\n    Signature Algorithm: ecdsa-with-SHA384\n        Issuer: C=US, O=DigiCert Inc, CN=DigiCert TLS Hybrid ECC SHA384 2020 CA1\n        Validity\n            Not Before: Feb 14 00:00:00 2023 GMT\n            Not After : Mar 14 23:59:59 2024 GMT\n        Subject: C=US, ST=California, L=San Francisco, O=GitHub, Inc., CN=github.com\n        Subject Public Key Info:\n            Public Key Algorithm: id-ecPublicKey\n                Public-Key: (256 bit)\n                pub: \n                    04:a3:a4:03:46:03:df:46:51:56:cb:c9:39:ab:22:\n                    cd:e7:6c:59:96:7a:93:a0:fb:b9:40:1c:90:32:88:\n                    36:c6:09:76:9c:50:f5:55:f7:76:5e:68:20:9c:ee:\n                    22:ed:83:0c:15:30:10:41:44:5e:32:ac:90:a1:d5:\n                    aa:f2:e5:43:b3\n                ASN1 OID: prime256v1\n                NIST CURVE: P-256\n        X509v3 extensions:\n            X509v3 Authority Key Identifier: \n                keyid:0A:BC:08:29:17:8C:A5:39:6D:7A:0E:CE:33:C7:2E:B3:ED:FB:C3:7A\n\n            X509v3 Subject Key Identifier: \n                C7:07:27:78:85:F2:9D:33:C9:4C:5E:56:7D:5C:D6:8E:72:67:EB:DE\n            X509v3 Subject Alternative Name: \n                DNS:github.com, DNS:www.github.com\n            X509v3 Key Usage: critical\n                Digital Signature\n            X509v3 Extended Key Usage: \n                TLS Web Server Authentication, TLS Web Client Authentication\n            X509v3 CRL Distribution Points: \n\n                Full Name:\n                  URI:http://crl3.digicert.com/DigiCertTLSHybridECCSHA3842020CA1-1.crl\n\n                Full Name:\n                  URI:http://crl4.digicert.com/DigiCertTLSHybridECCSHA3842020CA1-1.crl\n\n            X509v3 Certificate Policies: \n                Policy: 2.23.140.1.2.2\n                  CPS: http://www.digicert.com/CPS\n\n            Authority Information Access: \n                OCSP - URI:http://ocsp.digicert.com\n                CA Issuers - URI:http://cacerts.digicert.com/DigiCertTLSHybridECCSHA3842020CA1-1.crt\n\n            X509v3 Basic Constraints: \n                CA:FALSE\n            CT Precertificate SCTs: \n                Signed Certificate Timestamp:\n                    Version   : v1(0)\n                    Log ID    : EE:CD:D0:64:D5:DB:1A:CE:C5:5C:B7:9D:B4:CD:13:A2:\n                                32:87:46:7C:BC:EC:DE:C3:51:48:59:46:71:1F:B5:9B\n                    Timestamp : Feb 14 16:58:33.338 2023 GMT\n                    Extensions: none\n                    Signature : ecdsa-with-SHA256\n                                30:46:02:21:00:E4:16:AE:D3:E2:2C:BA:82:9F:A9:79:\n                                F2:4B:C6:94:52:ED:4D:E0:87:CC:50:CA:69:B1:B4:8F:\n                                05:77:3A:94:EB:02:21:00:B5:9F:C3:F9:CB:0F:AD:D0:\n                                60:F2:30:1B:71:05:72:12:0D:BD:65:1F:07:A9:9C:53:\n                                4B:76:95:12:04:A6:BF:2E\n                Signed Certificate Timestamp:\n                    Version   : v1(0)\n                    Log ID    : 48:B0:E3:6B:DA:A6:47:34:0F:E5:6A:02:FA:9D:30:EB:\n                                1C:52:01:CB:56:DD:2C:81:D9:BB:BF:AB:39:D8:84:73\n                    Timestamp : Feb 14 16:58:33.387 2023 GMT\n                    Extensions: none\n                    Signature : ecdsa-with-SHA256\n                                30:45:02:20:1E:3C:60:32:7E:20:51:F5:D6:E1:AF:7D:\n                                4D:F5:97:C4:48:2E:46:57:6B:86:05:37:32:4F:25:04:\n                                36:B1:F7:B7:02:21:00:FC:09:7E:C0:7C:03:83:26:36:\n                                BD:A7:5B:EB:1D:13:59:F6:62:20:8E:6D:6F:B7:0D:31:\n                                EB:DB:F5:11:EE:5B:D4\n                Signed Certificate Timestamp:\n                    Version   : v1(0)\n                    Log ID    : 3B:53:77:75:3E:2D:B9:80:4E:8B:30:5B:06:FE:40:3B:\n                                67:D8:4F:C3:F4:C7:BD:00:0D:2D:72:6F:E1:FA:D4:17\n                    Timestamp : Feb 14 16:58:33.402 2023 GMT\n                    Extensions: none\n                    Signature : ecdsa-with-SHA256\n                                30:46:02:21:00:CC:E0:6B:F4:E6:74:FB:A3:92:67:21:\n                                53:8B:2C:0D:EB:83:F2:B0:DD:05:2D:E2:D1:C8:BE:63:\n                                98:4B:18:AC:36:02:21:00:EE:D2:3B:60:5A:23:08:29:\n                                4E:82:33:47:4A:72:A5:16:2E:46:85:13:6D:DC:DA:25:\n                                80:85:80:07:AA:B1:51:47\n    Signature Algorithm: ecdsa-with-SHA384\n         30:64:02:30:04:dc:0d:d4:de:34:99:0a:9c:1f:a8:e1:c1:76:\n         5c:62:f4:04:a0:29:35:3e:c2:0d:2a:c3:71:6a:b5:f4:37:d4:\n         ec:0b:60:57:71:87:43:25:36:4f:c7:c2:48:d1:49:68:02:30:\n         56:d0:bc:c9:17:10:fb:cd:be:fe:2d:df:42:ba:c6:da:46:db:\n         aa:a6:67:ee:8e:88:84:81:20:85:cc:96:35:a7:b2:26:11:d6:\n         0c:99:9d:3c:c8:83:70:10:4b:0e:15:9b\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br"),a("span",{staticClass:"line-number"},[s._v("50")]),a("br"),a("span",{staticClass:"line-number"},[s._v("51")]),a("br"),a("span",{staticClass:"line-number"},[s._v("52")]),a("br"),a("span",{staticClass:"line-number"},[s._v("53")]),a("br"),a("span",{staticClass:"line-number"},[s._v("54")]),a("br"),a("span",{staticClass:"line-number"},[s._v("55")]),a("br"),a("span",{staticClass:"line-number"},[s._v("56")]),a("br"),a("span",{staticClass:"line-number"},[s._v("57")]),a("br"),a("span",{staticClass:"line-number"},[s._v("58")]),a("br"),a("span",{staticClass:"line-number"},[s._v("59")]),a("br"),a("span",{staticClass:"line-number"},[s._v("60")]),a("br"),a("span",{staticClass:"line-number"},[s._v("61")]),a("br"),a("span",{staticClass:"line-number"},[s._v("62")]),a("br"),a("span",{staticClass:"line-number"},[s._v("63")]),a("br"),a("span",{staticClass:"line-number"},[s._v("64")]),a("br"),a("span",{staticClass:"line-number"},[s._v("65")]),a("br"),a("span",{staticClass:"line-number"},[s._v("66")]),a("br"),a("span",{staticClass:"line-number"},[s._v("67")]),a("br"),a("span",{staticClass:"line-number"},[s._v("68")]),a("br"),a("span",{staticClass:"line-number"},[s._v("69")]),a("br"),a("span",{staticClass:"line-number"},[s._v("70")]),a("br"),a("span",{staticClass:"line-number"},[s._v("71")]),a("br"),a("span",{staticClass:"line-number"},[s._v("72")]),a("br"),a("span",{staticClass:"line-number"},[s._v("73")]),a("br"),a("span",{staticClass:"line-number"},[s._v("74")]),a("br"),a("span",{staticClass:"line-number"},[s._v("75")]),a("br"),a("span",{staticClass:"line-number"},[s._v("76")]),a("br"),a("span",{staticClass:"line-number"},[s._v("77")]),a("br"),a("span",{staticClass:"line-number"},[s._v("78")]),a("br"),a("span",{staticClass:"line-number"},[s._v("79")]),a("br"),a("span",{staticClass:"line-number"},[s._v("80")]),a("br"),a("span",{staticClass:"line-number"},[s._v("81")]),a("br"),a("span",{staticClass:"line-number"},[s._v("82")]),a("br"),a("span",{staticClass:"line-number"},[s._v("83")]),a("br"),a("span",{staticClass:"line-number"},[s._v("84")]),a("br"),a("span",{staticClass:"line-number"},[s._v("85")]),a("br"),a("span",{staticClass:"line-number"},[s._v("86")]),a("br"),a("span",{staticClass:"line-number"},[s._v("87")]),a("br"),a("span",{staticClass:"line-number"},[s._v("88")]),a("br"),a("span",{staticClass:"line-number"},[s._v("89")]),a("br"),a("span",{staticClass:"line-number"},[s._v("90")]),a("br"),a("span",{staticClass:"line-number"},[s._v("91")]),a("br"),a("span",{staticClass:"line-number"},[s._v("92")]),a("br"),a("span",{staticClass:"line-number"},[s._v("93")]),a("br"),a("span",{staticClass:"line-number"},[s._v("94")]),a("br"),a("span",{staticClass:"line-number"},[s._v("95")]),a("br"),a("span",{staticClass:"line-number"},[s._v("96")]),a("br")])]),a("p",[s._v("我们可以看到，证书主要包含两个部分， 分别为 数据载体和数据签名，其中数据签名使用ca的私钥对数据载体进行数据hash后的结果。我们主要看数据载体的内容。")]),s._v(" "),a("p",[s._v("数据载体主要包括：")]),s._v(" "),a("ul",[a("li",[s._v("证书颁发者信息 （Issuer）")]),s._v(" "),a("li",[s._v("证书主体信息 （Validity、Subject、Subject Public Key Info）")]),s._v(" "),a("li",[s._v("证书扩展信息 （X509v3 extensions）")])]),s._v(" "),a("p",[s._v("下面，我们主要解释一下证书扩展信息相关参数信息")]),s._v(" "),a("h2",{attrs:{id:"配置参数书写格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置参数书写格式"}},[s._v("#")]),s._v(" 配置参数书写格式")]),s._v(" "),a("p",[s._v("配置项可以写成单行（短形式），如下")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# name = [critical, ]value(s)\n\nbasicConstraints = critical, CA:true, pathlen:1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("也可以写成多行（长形式）形式：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("[extensions]\nbasicConstraints = critical, @basic_constraints\n\n[basic_constraints]\nCA = true\npathlen = 1\n\n# url = URI:ldap://somehost.com/CN=foo,OU=bar  multi-valued包含“，”，必须写为多行形式\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"}),a("p",[s._v("如果多值 value 中包含"),a("code",[s._v(",")]),s._v("，则必须写成多行形式（长形式）")])]),a("p",[s._v("其中value的格式主要有一下四类，我们编写配置的时候，主要用到前面两个（string、multi-valued）：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("string                  \nmulti-valued\t\t  \nraw\narbitrary\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"basic-constraints"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#basic-constraints"}},[s._v("#")]),s._v(" Basic  Constraints")]),s._v(" "),a("p",[s._v("值类型："),a("code",[s._v("multi-valued")])]),s._v(" "),a("p",[s._v("作用：标识该证书是否是"),a("code",[s._v("CA")]),s._v("证书， 如果"),a("code",[s._v("CA")]),s._v("为 "),a("code",[s._v("TRUE")]),s._v("，则可以包含可选的路径长度名称，后跟非负值。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("basicConstraints = CA:FALSE\n\nbasicConstraints = critical, CA:TRUE, pathlen:1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"}),a("p",[s._v("如果是CA证书，该值必须为TRUE，终端实体证书该字符需为FALSE或被忽略；pathlen 表示证书链的长度，为1表示只能签署一个中间人CA证书")])]),a("h2",{attrs:{id:"key-usage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#key-usage"}},[s._v("#")]),s._v(" Key Usage"),a("Badge",{attrs:{text:"重要"}})],1),s._v(" "),a("p",[s._v("值类型："),a("code",[s._v("multi-valued")])]),s._v(" "),a("p",[s._v("作用：声明证书中公钥的用途。\n包含一下几个值： "),a("code",[s._v("digitalSignature")]),s._v(", "),a("code",[s._v("nonRepudiation")]),s._v(", "),a("code",[s._v("keyEncipherment")]),s._v(", "),a("code",[s._v("dataEncipherment")]),s._v(", "),a("code",[s._v("keyAgreement")]),s._v(", "),a("code",[s._v("keyCertSign")]),s._v(", "),a("code",[s._v("cRLSign")]),s._v(", "),a("code",[s._v("encipherOnly")]),s._v(",\nand "),a("code",[s._v("decipherOnly")]),s._v(".")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("keyUsage = digitalSignature, nonRepudiation\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"extended-key-usage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#extended-key-usage"}},[s._v("#")]),s._v(" Extended Key Usage"),a("Badge",{attrs:{text:"重要"}})],1),s._v(" "),a("p",[s._v("值类型："),a("code",[s._v("multi-valued")])]),s._v(" "),a("p",[s._v("作用：对证书公钥的用途进行补充。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("Value                  Meaning according to RFC 5280 etc.\n-----                  ----------------------------------\nserverAuth             SSL/TLS WWW Server Authentication\nclientAuth             SSL/TLS WWW Client Authentication\ncodeSigning            Code Signing\nemailProtection        E-mail Protection (S/MIME)\ntimeStamping           Trusted Timestamping\nOCSPSigning            OCSP Signing\nipsecIKE               ipsec Internet Key Exchange\nmsCodeInd              Microsoft Individual Code Signing (authenticode)\nmsCodeCom              Microsoft Commercial Code Signing (authenticode)\nmsCTLSign              Microsoft Trust List Signing\nmsEFS                  Microsoft Encrypted File System\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 对等认证\nextendedKeyUsage = serverAuth, clientAuth\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"}),a("p",[s._v("虽然 IETF RFC 5280 规定 id-kp-serverAuth 和 id-kp-clientAuth 仅适用于 WWW，但实际上它们用于各种 TLS 客户端和服务器。")])]),a("h2",{attrs:{id:"subject-key-identifier"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#subject-key-identifier"}},[s._v("#")]),s._v(" Subject Key Identifier")]),s._v(" "),a("p",[s._v("值类型："),a("code",[s._v("string")]),s._v("；可选值包括：none，hash，hex string；")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("subjectKeyIdentifier = hash\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"authority-key-identifier"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#authority-key-identifier"}},[s._v("#")]),s._v(" Authority Key Identifier")]),s._v(" "),a("p",[s._v("值类型："),a("code",[s._v("string")])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("authorityKeyIdentifier = keyid, issuer\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"subject-alternative-name"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#subject-alternative-name"}},[s._v("#")]),s._v(" Subject Alternative Name  "),a("Badge",{attrs:{text:"重要"}})],1),s._v(" "),a("p",[s._v("值类型："),a("code",[s._v("multi-valued")])]),s._v(" "),a("p",[s._v("作用：主要用作证书验证的；我们知道证书主题中有个"),a("code",[s._v("Common Name")]),s._v("\n的字段，该字段服务端证书通常填写的是域名，而有时候我们该证书需要使用到多个域名或IP，此时我们可以将内容写在字段下面，作为扩展验证；")]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"}),a("p",[s._v("现在大多数主流验证程序先验证Subject中的CN字段，如果不相同，转而验证SAN(Subject Alternative Name)的内容。")])]),a("p",[s._v("该字段包含一下几种值：")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("email")]),s._v(" "),a("p",[s._v("email包含2个特殊的值：copy：将证书主题中的邮箱地址复制到扩展字段中； move：将证书主题中的邮箱地址移动到扩展字段中，主题中将不包含邮箱地址；")])]),s._v(" "),a("li",[a("p",[s._v("URI")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("DNS")]),s._v("：常用作服务器扩展域名验证")])]),s._v(" "),a("li",[a("p",[s._v("RID")])]),s._v(" "),a("li",[a("p",[a("strong",[s._v("IP")]),s._v("： 常用作服务器扩展IP地址验证")])]),s._v(" "),a("li",[a("p",[s._v("dirName(a distinguished name)")])]),s._v(" "),a("li",[a("p",[s._v("otherName")])])]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("subjectAltName = IP:13::17, IP: 192.168.1.128\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"crl-distribution-points"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#crl-distribution-points"}},[s._v("#")]),s._v(" CRL distribution points")]),s._v(" "),a("p",[s._v("值类型："),a("code",[s._v("multi-valued")]),s._v("\n作用： 标识了当前CA下吊销列表文件的下载地址， 判断当前证书是否吊销了，如果被吊销则被判定为无效证书。")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("crlDistributionPoints = URI:http://example.com/myca.crl, URI:http://example.org/my.crl\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"ct-precertificate-scts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ct-precertificate-scts"}},[s._v("#")]),s._v(" CT Precertificate SCTs")]),s._v(" "),a("p",[s._v("作用： 证书透明度(Certificate Transparency); 这个是标准中没有提到的一个比较新的拓展。CT主要搭配了CA服务器上公开的Log，将记录CA的行为日志，\n而每一个与当前证书相关的日志将被计入此字段，并被CA进行签名。校验阶段可以根据Log ID和timestamp查找日志中的对应操作，对证书进行审计以确定当前证书的合法性。")]),s._v(" "),a("p",[s._v("用途： 该字段的提出主要就是防止CA被入侵者利用后获取大量非法签发证书，而透明性的日志保证了证书的签发是到受到严格监控的。")]),s._v(" "),a("h2",{attrs:{id:"authority-information-access"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#authority-information-access"}},[s._v("#")]),s._v(" Authority Information Access")]),s._v(" "),a("p",[s._v("作用：标识了CA Issuer的信息，包括OCSP服务的网址与CA证书的下载地址。该部分在TLS很重要。OCSP服务会在后续CRL中提到。")]),s._v(" "),a("h2",{attrs:{id:"使用-x509v3配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-x509v3配置"}},[s._v("#")]),s._v(" 使用 x509v3配置")]),s._v(" "),a("p",[s._v("我们在提交完成csr文件后，需要通过证书扩展配置来扩展证书用途，使用方式如下：")]),s._v(" "),a("ol",[a("li",[s._v("首先我们编写扩展配置文件")])]),s._v(" "),a("p",[s._v("以服务端为例，我们需要使用证书作为服务端证书，创建"),a("code",[s._v("server-ext.conf")]),s._v("文件，进行如下配置：")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("subjectAltName = IP:192.168.1.128, DNS:king.com, DNS:king.site\nextendedKeyUsage = serverAuth\nsubjectKeyIdentifier = hash\nauthorityKeyIdentifier = keyid, issuer\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("使用证书，需要校验服务端的IP或DNS是否为扩展配置的内容。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("openssl x509 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-req")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-in")]),s._v(" server.csr "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-out")]),s._v(" server-cert.pem "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-CA")]),s._v(" ca.pem "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-CAkey")]),s._v(" ca-key.pem "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-CAcreateserial")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-days")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("365")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-extfile")]),s._v(" server-ext.conf\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("查看证书")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("openssl x509 "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-in")]),s._v(" server-cert.pem "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-noout")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-text")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=t.exports}}]);