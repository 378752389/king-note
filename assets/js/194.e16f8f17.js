(window.webpackJsonp=window.webpackJsonp||[]).push([[194],{653:function(s,a,e){"use strict";e.r(a);var t=e(3),n=Object(t.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"节点操作命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#节点操作命令"}},[s._v("#")]),s._v(" 节点操作命令")]),s._v(" "),a("p",[s._v("1.创建节点")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("create "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-s"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("-e"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("-t ttl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" path data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("acl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("-s：创建顺序节点，在节点名后自动添加递增序列号。")]),s._v(" "),a("li",[s._v("-e：创建临时节点，当客户端会话结束时，节点会被自动删除。")]),s._v(" "),a("li",[s._v("-c：创建容器节点（EPHEMERAL_SEQUENTIAL），即临时有序节点。")]),s._v(" "),a("li",[s._v("-t ttl：设置节点存活的超时时间（仅限ZooKeeper 3.5及以上版本）。")])]),s._v(" "),a("p",[s._v("2.查看节点内容")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("get "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-w")]),s._v(" path\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("w: 监听节点变化")])]),s._v(" "),a("p",[s._v("3.设置节点内容")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" path data\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("4.列出节点子目录")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v(" path\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("5.删除节点")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("delete "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" path \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("v 是可选的，用于指定删除前检查的数据版本。")])]),s._v(" "),a("p",[s._v("6.递归删除节点以其子节点")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("deleteall path\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("7.查看节点状态")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("stat")]),s._v(" path\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"节点权限控制命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#节点权限控制命令"}},[s._v("#")]),s._v(" 节点权限控制命令")]),s._v(" "),a("blockquote",[a("p",[s._v("zk的ACL列表构成主要由3部分：[schema : id : permissions]")])]),s._v(" "),a("h3",{attrs:{id:"acl-scheme-类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#acl-scheme-类型"}},[s._v("#")]),s._v(" ACL Scheme 类型")]),s._v(" "),a("ul",[a("li",[s._v("world: 任何人都可以访问；id值唯一，为 anyone")]),s._v(" "),a("li",[s._v("auth: 已经过身份验证的任何用户；id 一般为"),a("code",[s._v("username:password")]),s._v("的组合。 eg： admin:123")]),s._v(" "),a("li",[s._v("digest: 用户名:密码哈希；id 结构为"),a("code",[s._v("username:password_hash")]),s._v("，"),a("code",[s._v("password_hash")]),s._v("字段为"),a("code",[s._v("username:password")]),s._v(" 通过base64编码后进行hash映射后的内容。 eg digest:username:passwordhash.")]),s._v(" "),a("li",[s._v("ip: 根据 IP 地址限制访问；id为对应客户端的ip地址，eg ip:192.168.1.2")])]),s._v(" "),a("h3",{attrs:{id:"权限定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#权限定义"}},[s._v("#")]),s._v(" 权限定义")]),s._v(" "),a("ul",[a("li",[s._v("C: Create 子节点权限。")]),s._v(" "),a("li",[s._v("D: Delete 子节点权限（仅下一级节点）。")]),s._v(" "),a("li",[s._v("R: Read 节点数据和子节点列表。")]),s._v(" "),a("li",[s._v("W: Write 节点数据。")]),s._v(" "),a("li",[s._v("A: Admin 权限，包括设置 ACL 和删除非空节点的权利。")])]),s._v(" "),a("h3",{attrs:{id:"例子"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#例子"}},[s._v("#")]),s._v(" 例子")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置为 world 类型， 任何人都可以访问")]),s._v("\nsetAcl /node world:anyone:cdrwa\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置为 auth 类型， 需要通过 addauth 认证后才能访问")]),s._v("\nsetAcl /node auth:admin:123:cdrwa\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# [replace] => sha1(base64(admin:123))")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 需要通过 addauth 认证后才能访问")]),s._v("\nsetAcl /node digest:admin:"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("replace"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":cdrwa\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置为 ip 类型，在session 连接时，必须为对于的ip 才能访问")]),s._v("\nsetAcl /node ip:192.168.1.6:cdrwa\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对于 world 类型，不需要验证；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对于 ip 类型，客户端建立连接的时候就可以判断当前 session 是否拥有对应的节点权限；")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 对于 digest 和 auth 类型， 通常在客户端连接后需要进行权限认证， 一个session 中 可以进行多次验证并保留之前的认证结果。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# zk 中 的认证命令格式为：[addauth digest id]")]),s._v("\naddauth digest admin:123\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);