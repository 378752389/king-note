---
title: Nginx-动态代理配置
date: 2023-07-25
categories:
  - 中间件
sidebar: false
tags:
  - nginx
---

## 代理分类

* 正向代理分类：
    * 普通代理： 客户端需要手动指定代理服务器的ip地址和端口号； eg： squid
    * 透明代理： 客户端**不**需要手动指定代理服务器的ip地址和端口号； eg：网关

* 代理是否解密https分类：
    * 隧道代理： 不解密； eg：nginx
    * 中间人代理： 解密；eg： charles

## proxy_pass中url末尾带`/`与不带`/`区别

:::tip

如果 proxy_pass 后面对应的 url 不包含 路径，`http://(域名orIP):端口`, 则location路径保留，只替换域名和端口；
如果 proxy_pass 后面对应的 url 包含 路径，`http://(域名orIP):端口/[path]`, 则location路径会进行替换。

:::

测试地址: http://wenking.com/hello/asd

示例：
```
# =======================================================
# ===========↓↓↓↓↓↓↓↓↓末尾带 / ↓↓↓↓↓↓↓↓===================
# =======================================================
location ^~ /hello/ {
    proxy_pass http://192.168.1.128:8080/server/;
}

实际请求： http://192.168.1.128:8080/server/asd

location ^~ /hello/ {
    proxy_pass http://192.168.1.128:8080/;
}

实际请求： http://192.168.1.128:8080/asd

location ^~ /hello {
    proxy_pass http://192.168.1.128:8080/;
}

实际请求： http://192.168.1.128:8080//asd

# =======================================================
# ===========↑↑↑↑↑↑↑↑↑末尾带 / ↑↑↑↑↑↑↑↑===================
# =======================================================


# =======================================================
# ===========↓↓↓↓↓↓↓↓↓末尾不带 / ↓↓↓↓↓↓↓↓==================
# =======================================================

location ^~ /hello/ {
    proxy_pass http://192.168.1.128:8080/server;
}

实际请求： http://192.168.1.128:8080/serverasd

location ^~ /hello {
    proxy_pass http://192.168.1.128:8080/server;
}

实际请求： http://192.168.1.128:8080/server/asd

location ^~ /hello {
    proxy_pass http://192.168.1.128:8080;
}

实际请求： http://192.168.1.128:8080/hello/asd

# =======================================================
# ===========↑↑↑↑↑↑↑↑↑末不尾带 / ↑↑↑↑↑↑↑↑==================
# =======================================================
```

